connect /as sysdba
DROP TABLE scott.sales PURGE;

DROP TABLESPACE SALES_SYS_PART1_TBS INCLUDING CONTENTS AND DATAFILES;
DROP TABLESPACE SALES_SYS_PART2_TBS INCLUDING CONTENTS AND DATAFILES;
DROP TABLESPACE SALES_SYS_PART3_TBS INCLUDING CONTENTS AND DATAFILES;
DROP TABLESPACE SALES_SYS_PART4_TBS INCLUDING CONTENTS AND DATAFILES;

CREATE TABLESPACE SALES_SYS_PART1_TBS
DATAFILE '/u01/app/oracle/oradata/orcl/sales_sys_part01.dbf' size 20M autoextend on next 10M maxsize 100M;
CREATE TABLESPACE SALES_SYS_PART2_TBS 
DATAFILE '/u01/app/oracle/oradata/orcl/sales_sys_part02.dbf' size 20M autoextend on next 10M maxsize 100M;
CREATE TABLESPACE SALES_SYS_PART3_TBS
DATAFILE '/u01/app/oracle/oradata/orcl/sales_sys_part03.dbf' size 20M autoextend on next 10M maxsize 100M;
CREATE TABLESPACE SALES_SYS_PART4_TBS
DATAFILE '/u01/app/oracle/oradata/orcl/sales_sys_part04.dbf' size 20M autoextend on next 10M maxsize 100M;


CREATE TABLE scott.sales
        (sales_no 	NUMBER(2)	NOT NULL,
         sales_date 	DATE		NOT NULL,
 	 sales_region	CHAR(2),
         customer_id    NUMBER(5),
         price 		NUMBER(8))
PARTITION BY SYSTEM
        (
	PARTITION SALES_SYS_PART1 TABLESPACE SALES_SYS_PART1_TBS,
	PARTITION SALES_SYS_PART2 TABLESPACE SALES_SYS_PART2_TBS,
	PARTITION SALES_SYS_PART3 TABLESPACE SALES_SYS_PART3_TBS,
	PARTITION SALES_SYS_PART4 TABLESPACE SALES_SYS_PART4_TBS
	);

INSERT INTO scott.sales VALUES (1,'21-JAN-2013','NJ',8722,14);


INSERT INTO scott.sales PARTITION(SALES_SYS_PART1) VALUES (1,'21-FEB-2013','NJ',8722,14);
INSERT INTO scott.sales PARTITION(SALES_SYS_PART2) VALUES (2,'23-JUN-2014','NY',8722,22);
INSERT INTO scott.sales PARTITION(SALES_SYS_PART3) VALUES (3,'16-DEC-2015','CA',8723,15);
INSERT INTO scott.sales PARTITION(SALES_SYS_PART4) VALUES (4,'09-MAR-2016','PA',8724,18);
INSERT INTO scott.sales PARTITION(SALES_SYS_PART1) VALUES (5,'19-APR-2013','PA',8725,44);
INSERT INTO scott.sales PARTITION(SALES_SYS_PART2) VALUES (6,'31-MAY-2013','NJ',8725,51);
INSERT INTO scott.sales PARTITION(SALES_SYS_PART3) VALUES (7,'17-MAR-2013','NY',8726,38);
INSERT INTO scott.sales PARTITION(SALES_SYS_PART4) VALUES (8,'27-NOV-2015','NY',8723,39);
INSERT INTO scott.sales PARTITION(SALES_SYS_PART1) VALUES (9,'15-JUN-2014','CA',8723,11);
INSERT INTO scott.sales PARTITION(SALES_SYS_PART2) VALUES (10,'25-MAY-2015','NJ',8723,23);
INSERT INTO scott.sales PARTITION(SALES_SYS_PART3) VALUES (11,'21-FEB-2013','NJ',8262,14);
INSERT INTO scott.sales PARTITION(SALES_SYS_PART4) VALUES (12,'23-JUN-2014','NY',8722,22);
INSERT INTO scott.sales PARTITION(SALES_SYS_PART1) VALUES (13,'16-DEC-2015','CA',8523,15);
INSERT INTO scott.sales PARTITION(SALES_SYS_PART2) VALUES (14,'09-MAR-2016','PA',8764,28);
INSERT INTO scott.sales PARTITION(SALES_SYS_PART3) VALUES (15,'19-APR-2013','PA',8729,44);
INSERT INTO scott.sales PARTITION(SALES_SYS_PART4) VALUES (16,'31-MAY-2013','NJ',8725,31);
INSERT INTO scott.sales PARTITION(SALES_SYS_PART1) VALUES (17,'17-MAR-2013','NY',8226,38);
INSERT INTO scott.sales PARTITION(SALES_SYS_PART2) VALUES (18,'27-NOV-2015','NY',8323,39);
INSERT INTO scott.sales PARTITION(SALES_SYS_PART3) VALUES (19,'15-JUN-2014','CA',8743,16);
INSERT INTO scott.sales PARTITION(SALES_SYS_PART4) VALUES (20,'25-MAY-2015','NJ',8723,23);
commit;



EXEC DBMS_STATS.gather_table_stats('SCOTT', 'SALES');
col table_name format a10
col tablespace_name format a20
col partition_name format a20
col num_rows format 99
set linesize 120
set pagesize 200
SELECT table_name, tablespace_name, partition_name, num_rows
FROM dba_tab_partitions where table_name='SALES' and table_owner='SCOTT'
ORDER by table_name, partition_name; 

